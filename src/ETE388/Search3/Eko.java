package ETE388.Search3;


import java.util.ArrayList;
import java.util.Arrays;
import java.util.Random;
import java.util.Scanner;
import java.util.stream.IntStream;

public class Eko {

    private int n;
    private int m;
    private int sum;
    private int max;
    int[] trees;
    public Eko(){
        Scanner scanner = new Scanner(System.in);
        n = scanner.nextInt();
        m = scanner.nextInt();
        trees = new int[n];
        sum = 0;
        max = 0;
        for (int i=0; i<n; i++){
            trees[i] = scanner.nextInt();
            sum += trees[i];
            if (max < trees[i]){
                max = trees[i];
            }
        }

        //System.out.println(max);
        //System.out.println(sum);
        //System.out.println(Arrays.toString(trees));
        //System.out.println((n));
        //System.out.println((m));

        //naive();
        System.out.println(binary());
    }


    private int binary;
    private int naive;
    public Eko(int n, int m, int[]trees){
        this.n=n;
        this.m=m;
        this.trees=trees;
        max = Arrays.stream(trees).max().getAsInt();
        binary=binary();
        naive = naive();
    }

    private int binary(){
        int low = 0;
        int high = max;
        int lastMid = 0;

        while (low <= high){
            int mid = low + (high-low) / 2;
            long wood = calc(mid);
            //enough wood
            if (wood==m){
                return mid;
            }

            if (wood > m){
                lastMid = mid;
                low = mid+1;
            }
            else {
                high = mid-1;
            }
        }
        //System.out.println("test");
        return lastMid;

    }

    private long calc(int height){
        long wood = 0;
        for (int tree : trees) {
            if (tree>height){
                wood += (tree-height);
            }
        }
        return wood;
    }
    private int naive(){
        int wood = 0;
        int height = max;
        while (wood < m){
            height--;
            for (int tree : trees) {
                if (tree>height){
                    wood++;
                }
            }
        }
        return (height);
        //  System.out.println(wood);
    }



    public static void main(String[] args) {
        new Eko();



        //test generator

/*
        int i = 0;
     //   while (true) {
            Random rand = new Random();
            int n = 949; // rand.nextInt(1,1000);
            int m = 32; //rand.nextInt(1,2000);
            //int[] trees  = new int[n];
            int[] trees  = {682556353, 634177802, 678637604, 866707609, 271452201, 908322300, 258967132, 267626050, 150358941, 625996119, 909513682, 459210158, 396205593, 788566021, 650315008, 608782002, 421782084, 838434945, 631739862, 542443169, 691529474, 492778520, 379607698, 553794689, 742400549, 375312542, 287082184, 888158443, 758693955, 600821481, 877985408, 885293449, 920653217, 664137680, 803453821, 99099685, 16398414, 566774232, 549936283, 600483690, 287761743, 862292351, 430380883, 523337533, 846028524, 466965545, 172751031, 210421810, 41066915, 990760036, 399706044, 927649650, 873441873, 29452814, 958180355, 474478074, 840660433, 156318470, 727326474, 647197996, 522083632, 676350019, 268323694, 211493708, 216394133, 611907310, 361571133, 134050973, 306360271, 7046221, 250754750, 37805125, 6310059, 235867125, 469794253, 882937817, 245438959, 261833398, 513243590, 105748720, 296773149, 451163292, 899261268, 103269076, 356853943, 383491233, 748251902, 263537966, 877024528, 958372549, 200217453, 565171828, 208235899, 262048394, 720229472, 556905092, 878140607, 313814367, 732049489, 854298234, 706677594, 63628376, 625503261, 753222911, 119077360, 376884927, 224037600, 243736850, 914570572, 290141478, 868553190, 384875508, 359107543, 504128416, 441266399, 405862741, 347898917, 774510248, 365143488, 339674085, 590372319, 956813371, 373416935, 787008625, 7751081, 887720822, 484071033, 972160916, 208791365, 81161185, 221299432, 398097, 58994423, 342935892, 626701720, 313392335, 388274663, 710186626, 22963353, 239541106, 752665021, 655822377, 844834446, 701109914, 719371602, 146914003, 80347053, 41326258, 40903294, 526056265, 19882217, 510944887, 215158541, 36266390, 15559970, 529923590, 585456844, 157693108, 718538907, 951405470, 490955974, 541091027, 967529071, 196620796, 86098317, 727966285, 201791544, 950627400, 470950058, 903504163, 820696527, 465361342, 389593909, 491447084, 826678580, 740657374, 973759371, 833194210, 664269958, 989367886, 786549265, 407922888, 745179689, 239336780, 320013110, 596979576, 97128570, 319650378, 332671760, 155478183, 969072795, 339707760, 416555696, 357093661, 734795199, 635779121, 626457164, 954481030, 749365613, 652131591, 408921914, 8516963, 918099200, 766675737, 948344900, 44592191, 140712138, 493531583, 521529048, 527071017, 409564989, 978411682, 887622359, 438373267, 170768349, 173234997, 658414702, 218614781, 455072936, 852329896, 27919019, 123383378, 173018559, 504628908, 103109723, 796292126, 680943196, 70679056, 513597341, 604322897, 429253217, 301153613, 261538817, 93383959, 922146203, 824461631, 673691997, 912880098, 822263958, 700443378, 753999149, 836661129, 351194394, 104565138, 468574886, 525318728, 177288580, 22062933, 573351299, 910549070, 4474001, 441604727, 439803766, 946378689, 308965696, 529756887, 121971374, 303400764, 507111263, 98051938, 156443363, 255377654, 968497725, 68319897, 187137209, 268108356, 393598765, 692207718, 866408006, 414817660, 100404466, 245328825, 963386443, 97095126, 896963055, 468651300, 935743974, 834598346, 659373604, 146869108, 570297667, 661344216, 670105573, 938407894, 362084559, 976088766, 197763973, 724563869, 243338678, 274227372, 344846537, 829546262, 553149108, 631001619, 330005703, 275613413, 746264952, 656726786, 112452077, 186698514, 452323169, 732698510, 804417252, 52576825, 60191872, 410145061, 364249877, 964618267, 220086504, 984821117, 909798970, 790267962, 408551613, 452035804, 554723246, 242745243, 611427239, 9286416, 226855512, 598478964, 997777947, 834312568, 573547475, 147832309, 771520842, 994441424, 54023380, 632469347, 699802763, 434196011, 266642485, 776807765, 839616123, 227880189, 870217885, 755581221, 256281525, 819834968, 7586510, 424278626, 82093875, 121550639, 966195340, 891914878, 868035647, 685830103, 251621412, 62680714, 21681168, 679605388, 606464672, 80343319, 544425261, 597815430, 557380154, 652083077, 87035404, 186401094, 453158836, 982286438, 413164505, 66682186, 964813093, 486340381, 667760826, 122269333, 495312511, 67700076, 882955393, 570505237, 912300669, 312021696, 447342069, 490395532, 668405063, 92555049, 979112777, 837993493, 695859509, 576637425, 476032426, 730157395, 668281268, 801629664, 253455355, 494183230, 130445380, 824086795, 271312540, 306373249, 273099675, 267954258, 837920862, 50651877, 964578433, 286600861, 25291346, 670093563, 695175781, 56405597, 63119568, 821755428, 420274898, 6180847, 720791862, 394851662, 350626934, 243842419, 960873090, 645728347, 998327793, 674107815, 522501493, 220610297, 471921062, 90164337, 23164270, 430806662, 186775740, 654437157, 42978308, 508372483, 827905142, 826608312, 853135657, 830509578, 187371336, 939292084, 897691335, 532912408, 941221822, 636427246, 766655689, 79733865, 731929842, 251117697, 861213857, 625828402, 775678802, 227907685, 135697636, 701466321, 51615610, 557953189, 341516784, 520120467, 693612857, 951644230, 825887179, 636009507, 730208175, 208579849, 971480975, 405066175, 564930518, 583000290, 158821361, 320114941, 506798313, 592329836, 762214845, 467553195, 126041269, 165803743, 268720559, 469233950, 202709144, 474442000, 378361414, 920090762, 359580958, 957735429, 960514561, 674421991, 319533216, 448166424, 106799853, 493298979, 962997875, 890384370, 730565438, 281505992, 567309236, 49908009, 543819937, 739180017, 315956302, 404276792, 666356333, 213441523, 768753175, 833550784, 537111293, 200225550, 949858328, 154671732, 22906462, 287700743, 553787302, 398152465, 187578270, 3918555, 640682604, 725854433, 760106764, 617275768, 42345843, 558457845, 82332, 513617242, 937013221, 654152003, 780619335, 883431368, 903878916, 715016987, 481060848, 542358295, 79797691, 592487971, 759946379, 461512850, 951791636, 7447414, 744660330, 337278146, 765049801, 78318146, 863623928, 225271018, 365202761, 235543181, 723123823, 646092346, 529179417, 382803267, 695506930, 540918359, 56257521, 443921673, 333736031, 613411527, 88738153, 103389258, 859251390, 21942029, 520720589, 652252303, 171401640, 454483801, 572537540, 324698112, 956278090, 340268715, 966555259, 898082459, 672023568, 27881361, 661397569, 177097652, 304207307, 145508110, 659850415, 877163902, 390695830, 536372142, 842665683, 920472004, 560005174, 907948458, 171658811, 737316322, 483445201, 691481328, 515987427, 675848548, 543824611, 118015096, 20871981, 531379014, 255272121, 997071556, 788336894, 413128808, 810995392, 564566275, 62139221, 799993995, 896270013, 966913827, 220595079, 939982645, 782703254, 682963732, 909572856, 338786416, 413685541, 291056176, 77986089, 329790784, 400872482, 696025924, 984183234, 901122878, 402809661, 481019466, 910710496, 379946576, 791485044, 252485620, 722710182, 744564878, 319559926, 70058078, 851221372, 472547600, 428556789, 439649161, 746640008, 462815519, 366751552, 3109303, 186553427, 470698813, 67401500, 958617324, 414409936, 710619017, 69721859, 813592441, 279754569, 64516085, 885322876, 566591101, 425134833, 604382614, 799000847, 300830340, 889219785, 283323738, 484784440, 998779949, 419235860, 962531884, 180503636, 736143989, 107060126, 965036845, 153658102, 110689747, 161699755, 66480077, 453712199, 598451244, 305986549, 140590801, 709032789, 982112034, 207198070, 266413952, 474642843, 149393737, 78922069, 883456322, 895652045, 240111995, 828547521, 662579181, 621142119, 852671453, 376896611, 594185645, 431410122, 895811657, 65368409, 852199995, 472886912, 521667655, 727656499, 498624076, 419470000, 967780241, 47913996, 238131845, 946442983, 532032183, 835490001, 637207234, 375090223, 460023949, 620951242, 712943874, 87207614, 665445831, 951112700, 512975335, 320808422, 252582338, 836348108, 175526687, 473847472, 784620003, 176139099, 248031206, 832761686, 69833647, 75191049, 831478265, 729903604, 771908731, 976963931, 248183915, 180237604, 103537919, 475423859, 396135631, 986741912, 552155539, 949922470, 284662550, 588516146, 442768941, 809940785, 50647652, 524416918, 277919961, 419999248, 139973897, 338803108, 399329111, 256537825, 404885205, 388528308, 239955111, 624335212, 465053049, 855666619, 900011740, 84669728, 124174986, 255820519, 107051649, 186044763, 753413670, 681927061, 439107492, 33612473, 529246221, 441521772, 951256452, 122623078, 782887557, 675604937, 19765191, 912968379, 149042137, 750416527, 606304337, 68410415, 748881195, 458624975, 22070544, 724260948, 886235057, 999840113, 556219069, 568280186, 862200881, 713667311, 333180717, 212228175, 354755921, 547682887, 852359586, 68905546, 870391077, 962631886, 389994216, 672912562, 416746635, 220534884, 5905018, 912467929, 57797176, 809741603, 980995869, 745117971, 221751597, 480452058, 59533738, 372833622, 863840328, 958873927, 155299817, 186854762, 85257464, 317736912, 831819673, 503691724, 386013581, 665338405, 282303390, 348955511, 84709103, 631287393, 819598139, 273331893, 617511754, 195207897, 575016340, 373568759, 558971590, 941349996, 593556348, 851585099, 9537857, 784778878, 187668960, 192367793, 32663868, 381638268, 934239761, 773633357, 587048727, 347114517, 915526512, 836671331, 863071349, 937941183, 922560551, 711811721, 223713891, 671860021, 646320495, 903708116, 24967660, 758716592, 784371451, 729258829, 962567120, 241219848, 104539224, 886096554, 9556076, 156075137, 261183350, 53896406, 992417373, 896368988, 109102023, 599151307, 160585348, 721057296, 203839640, 781259495, 886181742, 232773327, 863851655, 1049113, 622082811, 914761545, 772087376, 796220003, 689772435, 261129519, 874445968, 314431361, 868162648, 805191404, 922526775, 43314465, 309275505, 763566223, 579808827, 565467879, 245846916, 14108495, 250070345, 768099847, 95077438, 471581118, 294500282, 767506042, 300341779, 95304334, 183527813, 165847514, 281410307, 963700219, 594912360, 741584353, 934153684, 338991660, 553014906, 424016604, 462638634, 479558398, 51942272, 751482559, 955835028, 106027518, 962176821, 67224604, 167171543, 232760754, 136040387, 38612866, 99900558, 127925262, 548028872, 973137712, 343233549, 844059778, 232914234, 775963775, 454842217, 839642275, 509405646, 206240442, 45600253, 728438454, 319573907, 29751953, 503582532, 279392573, 789654184, 120477539, 482916613, 841961296, 918058839, 970842036, 437081248, 432395399, 669394136, 960008804, 81796359, 759650892, 481632028, 167586248, 981689238, 355598985, 741209898, 794020973, 472492298, 854273623, 933829419, 267241777, 269295341, 952749296};

            *//*while (true) {
                trees = rand.ints(n, 1, 1000000000).toArray();
                if (IntStream.of(trees).sum() >= m){
                    break;
                }
            }*//*

            Eko eko = new Eko(n, m, trees);
           // if (eko.naive != eko.binary){

                System.out.println("n = " + n);
                System.out.println("m = " +m);
                System.out.println("naive: " + eko.naive);
                System.out.println("binary: " + eko.binary);
                System.out.println(Arrays.toString(trees));*/

          //      break;
     //       }
       //    System.out.println(i++);
      //  }
/*
        int naiveHeight = 999840081;
        int binaryHeight = 290177286;

        int woodBinary = 0;
        int woodNaive = 0;
        for (int tree: trees) {

            if (naiveHeight<tree){
                woodNaive+= tree-naiveHeight;
            }

            if (binaryHeight<tree){
                woodBinary+= tree-binaryHeight;
            }
        }

        System.out.println("------------------");
        System.out.println(woodNaive);
        System.out.println(woodBinary);
*/
        //Arrays.sort(trees);
        //System.out.println(trees[0]);
        //System.out.println(trees[trees.length-1]);

    }



}
